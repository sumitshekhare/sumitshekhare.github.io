<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Alphabet Order Game - Interact.js working drop</title>
<style>
  body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background-color: #f9f9f9;
    }

    h2 {
      font-size: 24px;
      margin-bottom: 20px;
    }

    .question {
      font-size: 22px;
      margin-bottom: 10px;
    }

    .letter-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .letter-box, .drop-zone {
      width: 70px;
      height: 70px;
      font-size: 32px;
      line-height: 70px;
      border: 2px solid #000;
      border-radius: 6px;
      background-color: #fff;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .drop-zone {
      border-style: dashed;
    }

    .options {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .option, .dropped {
      width: 60px;
      height: 60px;
      line-height: 60px;
      border: none;
      border-radius: 8px;
      background-color: #4285f4;
      color: white;
      font-size: 24px;
      font-weight: bold;
      user-select: none;
      text-align: center;
      cursor: grab;
      touch-action: none;
      transition: transform 0.15s ease, opacity 0.15s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dropped.correct {
      background-color: green;
    }
    .dropped.incorrect {
      background-color: red;
    }

    .feedback {
      font-size: 36px;
      margin-top: 20px;
    }

    .tick {
      color: green;
      display: none;
    }
    .cross {
      color: red;
      display: none;
    }

    #retryBtn, #nextBtn {
      margin-top: 15px;
      padding: 10px 24px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      display: none;
      color: white;
    }

    #retryBtn {
      background: #f44336;
    }
    #retryBtn:hover {
      background: #d32f2f;
    }

    #nextBtn {
      background: #4caf50;
    }
    #nextBtn:hover {
      background: #388e3c;
    }
</style>
</head>
<body>

<h2>Alphabet Order Game</h2>
<div class="question">Guess the After Letter</div>
<div class="letter-row">
  <div id="leftLetter" class="letter-box"></div>
  <div class="drop-zone" id="dropZone"></div>
</div>
<div id="dropZone"></div>

<div  class="options"  id="options"></div>

<div class="feedback">
  <span id="tick" class="tick">✔️</span>
  <span id="cross"  class="cross" >❌</span>
</div>

<button id="retryBtn">Retry</button>
<button id="nextBtn">Next</button>

<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<script>
  const alphabet = "क,ख,ग,घ,ङ,च,छ,ज,झ,ञ,ट,ठ,ड,ढ,ण,त,थ,द,ध,न,प,फ,ब,भ,म,य,र,ल,व,श,ष,स,ह,क्ष,त्र,ज्ञ,श्र".split(",");
let remainingLetters = alphabet.slice(0, 36); // exclude last letter अः (no next letter)
let currentQuestion = { letter: "", correctAnswer: "" };
let currentOptions = [];
let dropped = false;

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

function getDistractors(questionLetter, correctLetter) {
  const distractors = [];
  while (distractors.length < 2) {
    const rand = alphabet[Math.floor(Math.random() * alphabet.length)];
    if (rand !== correctLetter && rand !== questionLetter && !distractors.includes(rand)) {
      distractors.push(rand);
    }
  }
  return distractors;
}

function loadQuestion() {
  dropped = false;
  document.getElementById("tick").style.display = "none";
  document.getElementById("cross").style.display = "none";
  document.getElementById("retryBtn").style.display = "none";
  document.getElementById("nextBtn").style.display = "none";
  document.getElementById("dropZone").innerHTML = "";

  // Reset remaining letters if empty
  if (remainingLetters.length === 0) {
    remainingLetters = alphabet.slice(0, 36); // exclude last letter again
  }

  // Pick a random question letter from remaining list
  const idx = Math.floor(Math.random() * remainingLetters.length);
  const letter = remainingLetters.splice(idx, 1)[0];

  // Get index in full alphabet
  const letterIndex = alphabet.indexOf(letter);

  // Find correct answer by position (avoid last index)
  const correctAnswer = alphabet[letterIndex + 1];

  currentQuestion = { letter, correctAnswer };

  // Show question
  document.getElementById("leftLetter").innerHTML = `<strong>${letter}</strong>`;

  // Generate options
  const distractors = getDistractors(letter, correctAnswer);
  currentOptions = shuffle([correctAnswer, ...distractors]);

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";
  currentOptions.forEach(l => {
    const d = document.createElement("div");
    d.className = "option";
    d.textContent = l;
    d.setAttribute("data-letter", l);
    d.style.opacity = 1;
    d.style.pointerEvents = "auto";
    d.style.transform = "translate(0, 0)";
    d.setAttribute("data-x", 0);
    d.setAttribute("data-y", 0);
    optionsDiv.appendChild(d);
  });

  initDragDrop();
}


  function retry() {
    dropped = false;
    document.getElementById("tick").style.display = "none";
    document.getElementById("cross").style.display = "none";
    document.getElementById("retryBtn").style.display = "none";
    document.getElementById("nextBtn").style.display = "none";
    document.getElementById("dropZone").innerHTML = "";

    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";
    currentOptions.forEach(l => {
      const d = document.createElement("div");
      d.className = "option";
      d.textContent = l;
      d.setAttribute("data-letter", l);
      d.style.opacity = 1;
      d.style.pointerEvents = "auto";
      d.style.transform = "translate(0, 0)";
      d.setAttribute("data-x", 0);
      d.setAttribute("data-y", 0);
      optionsDiv.appendChild(d);
    });

    initDragDrop();
  }

  function nextQuestion() {
    loadQuestion();
  }

  function initDragDrop() {
    interact('.option').draggable({
      inertia: false,
      modifiers: [
        interact.modifiers.restrict({
          restriction: 'parent',
          endOnly: true,
        }),
      ],
      listeners: {
        move(event) {
          const target = event.target;
          let x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
          let y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

          target.style.transform = `translate(${x}px, ${y}px)`;
          target.setAttribute('data-x', x);
          target.setAttribute('data-y', y);
        },
        end(event) {
          if (!dropped) {
            resetTransform(event.target);
          }
        }
      }
    });

    interact('#dropZone').dropzone({
      accept: '.option',
      overlap: 0.75,
      ondrop(event) {
        dropped = true;
        const letter = event.relatedTarget.getAttribute("data-letter");
        const dropZone = document.getElementById("dropZone");
        const tick = document.getElementById("tick");
        const cross = document.getElementById("cross");
        const retryBtn = document.getElementById("retryBtn");
        const nextBtn = document.getElementById("nextBtn");

        dropZone.innerHTML = "";

        const droppedDiv = document.createElement("div");
        droppedDiv.className = "dropped";
        droppedDiv.textContent = letter;

        if (letter === currentQuestion.correctAnswer) {
          droppedDiv.classList.add("correct");
          tick.style.display = "inline";
          cross.style.display = "none";
          retryBtn.style.display = "none";
          nextBtn.style.display = "inline";
        } else {
          droppedDiv.classList.add("incorrect");
          tick.style.display = "none";
          cross.style.display = "inline";
          retryBtn.style.display = "inline";
          nextBtn.style.display = "none";
        }

        dropZone.appendChild(droppedDiv);

        // Reset transform and hide dragged option cleanly
        event.relatedTarget.style.transform = "translate(0, 0)";
        event.relatedTarget.setAttribute("data-x", 0);
        event.relatedTarget.setAttribute("data-y", 0);
        event.relatedTarget.style.opacity = 0;
        event.relatedTarget.style.pointerEvents = "none";
      }
    });
  }

  function resetTransform(el) {
    el.style.transform = "translate(0, 0)";
    el.setAttribute("data-x", 0);
    el.setAttribute("data-y", 0);
  }

  // Initialize the first question
  loadQuestion();

  // Attach button events
  document.getElementById("retryBtn").onclick = retry;
  document.getElementById("nextBtn").onclick = nextQuestion;
</script>

</body>
</html>
